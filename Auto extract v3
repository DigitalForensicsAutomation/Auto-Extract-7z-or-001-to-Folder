function Show-ExtractionProgress($archiveBase, $firstPart, $destination) {

    Log-Message "Starting extraction with progress bar..." "PROCESS"

    $psi = New-Object System.Diagnostics.ProcessStartInfo
    $psi.FileName = $sevenZip
    $psi.Arguments = "x `"$firstPart`" -o`"$destination`" -y"
    $psi.RedirectStandardOutput = $true
    $psi.UseShellExecute = $false
    $psi.CreateNoWindow = $true

    $proc = [System.Diagnostics.Process]::Start($psi)

    while (-not $proc.HasExited) {
        $line = $proc.StandardOutput.ReadLine()

        if ($line -match "\s(\d{1,3})%") {
            $pct = [int]$matches[1]
            Write-Progress -Activity "Extracting $archiveBase" -Status "$pct% complete" -PercentComplete $pct
        }
    }

    Write-Progress -Activity "Extracting $archiveBase" -Completed
    return $proc.ExitCode
}
